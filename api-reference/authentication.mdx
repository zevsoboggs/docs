---
title: 'Аутентификация'
description: 'Как аутентифицироваться в Love&Pay API'
---

## API ключ

Все запросы к Love&Pay API требуют аутентификации с помощью API ключа. Ключ передаётся в заголовке `x-api-key`.

```bash
curl -X GET "https://loveandpay.io/api/v1/invoices" \
  -H "x-api-key: YOUR_API_KEY"
```

## Получение API ключа

<Steps>
  <Step title="Войдите в панель управления">
    Перейдите в [панель управления](https://loveandpay.io/dashboard) и войдите в свой аккаунт.
  </Step>
  <Step title="Перейдите в настройки API">
    В боковом меню выберите **Настройки** → **API ключи**.
  </Step>
  <Step title="Создайте новый ключ">
    Нажмите **Создать ключ** и укажите название для идентификации.
  </Step>
  <Step title="Сохраните ключ">
    Скопируйте и сохраните ключ в безопасном месте. Ключ показывается только один раз.
  </Step>
</Steps>

## Безопасность

<Warning>
  Никогда не передавайте API ключ в публичный код или клиентские приложения. Храните ключи только на сервере.
</Warning>

### Рекомендации

- Используйте переменные окружения для хранения ключей
- Регулярно ротируйте ключи
- Создавайте отдельные ключи для разных сред (разработка, продакшн)
- Немедленно отзывайте скомпрометированные ключи

## Пример использования

<CodeGroup>

```javascript Node.js
const response = await fetch('https://loveandpay.io/api/v1/invoices', {
  method: 'GET',
  headers: {
    'x-api-key': process.env.LOVEANDPAY_API_KEY,
    'Content-Type': 'application/json'
  }
});

const data = await response.json();
```

```python Python
import requests
import os

response = requests.get(
    'https://loveandpay.io/api/v1/invoices',
    headers={
        'x-api-key': os.environ['LOVEANDPAY_API_KEY'],
        'Content-Type': 'application/json'
    }
)

data = response.json()
```

```go Go
package main

import (
    "net/http"
    "os"
)

func main() {
    client := &http.Client{}
    req, _ := http.NewRequest("GET", "https://loveandpay.io/api/v1/invoices", nil)
    req.Header.Add("x-api-key", os.Getenv("LOVEANDPAY_API_KEY"))
    req.Header.Add("Content-Type", "application/json")

    resp, _ := client.Do(req)
    defer resp.Body.Close()
}
```

</CodeGroup>

## Тестирование API в документации

Вы можете тестировать API запросы прямо из этой документации! На каждой странице эндпоинта справа есть панель **API Playground**.

<Steps>
  <Step title="Откройте страницу эндпоинта">
    Например, [Создание счёта](/api-reference/invoices/create)
  </Step>
  <Step title="Введите API ключ">
    В правой панели нажмите на поле **x-api-key** и вставьте ваш ключ. Он сохранится в браузере для всех запросов.
  </Step>
  <Step title="Заполните параметры">
    Укажите необходимые параметры запроса (amount, currency и т.д.)
  </Step>
  <Step title="Отправьте запрос">
    Нажмите **Send** и увидите реальный ответ от API
  </Step>
</Steps>

<Info>
  API ключ сохраняется локально в вашем браузере и не передаётся никуда кроме серверов Love&Pay.
</Info>

## Коды ошибок аутентификации

| Код | Описание |
|-----|----------|
| 401 | API ключ отсутствует или недействителен |
| 403 | API ключ не имеет доступа к запрашиваемому ресурсу |
| 429 | Превышен лимит запросов |

## Ограничения и защита API

Для обеспечения стабильной работы сервиса и защиты от злоупотреблений, Love&Pay использует систему мониторинга API запросов.

### Лимиты запросов

При нормальном использовании API вы не столкнётесь с ограничениями. Однако система автоматически отслеживает аномальную активность:

- Чрезмерно частые запросы за короткий промежуток времени
- Большое количество неудачных попыток аутентификации
- Подозрительные паттерны использования API

### Блокировка API ключа

<Warning>
  В случае обнаружения подозрительной активности, система безопасности может **временно заблокировать** ваш API ключ для защиты вашего аккаунта и предотвращения возможных атак.
</Warning>

При блокировке API будет возвращать ошибку:

```json
{
  "error": "API_KEY_SUSPENDED",
  "message": "Ваш API ключ временно заблокирован из-за подозрительной активности"
}
```

### Что делать если ключ заблокирован?

<Steps>
  <Step title="Не паникуйте">
    Блокировка — это мера предосторожности. Ваши данные в безопасности.
  </Step>
  <Step title="Проверьте свой код">
    Убедитесь, что в вашем коде нет бесконечных циклов или ошибок, вызывающих массовые запросы.
  </Step>
  <Step title="Свяжитесь с поддержкой">
    Напишите нам в онлайн-чат на сайте [loveandpay.io](https://loveandpay.io) — мы быстро разберёмся в ситуации и разблокируем ключ.
  </Step>
  <Step title="Переиндексируйте ключ">
    После снятия блокировки перейдите в [настройки API](https://loveandpay.io/dashboard/api) и нажмите **Переиндексировать** рядом с вашим ключом. Без этого шага ключ не заработает!
  </Step>
</Steps>

<Warning>
  **Важно:** После разблокировки обязательно переиндексируйте API ключ в [панели управления](https://loveandpay.io/dashboard/api). Без переиндексации ключ останется неактивным.
</Warning>

<Card title="Онлайн-чат поддержки" icon="comments" href="https://loveandpay.io">
  Наша команда поддержки доступна в онлайн-чате на сайте **loveandpay.io**. Мы оперативно поможем разблокировать API ключ и разобраться в причинах блокировки.
</Card>

### Рекомендации для стабильной работы

<CardGroup cols={2}>
  <Card title="Используйте кэширование" icon="database">
    Кэшируйте ответы API где возможно, чтобы уменьшить количество запросов
  </Card>
  <Card title="Обрабатывайте ошибки" icon="triangle-exclamation">
    Реализуйте exponential backoff при получении ошибок 429 или 5xx
  </Card>
  <Card title="Batch запросы" icon="layer-group">
    Используйте [Batch API](/api-reference/batch) для массовых операций вместо множества отдельных запросов
  </Card>
  <Card title="Вебхуки вместо polling" icon="bell">
    Настройте [вебхуки](/api-reference/webhooks/create) для получения уведомлений вместо постоянного опроса API
  </Card>
</CardGroup>
